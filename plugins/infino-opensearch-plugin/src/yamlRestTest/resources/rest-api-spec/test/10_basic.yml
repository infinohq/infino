---
"Test Cat Plugins Endpoint":
  - do:
      cat.plugins:
        h: component
  - match:
      $body: /^infino-opensearch-plugin/      
---
setup:
  - do:
      indices.create:
        index: test_index
        body:
          settings:
            index:
              number_of_shards: 1
              number_of_replicas: 0
---
"Index a single document":
  - do:
      index:
        index: test_index
        id: 1
        body:  
          - { "test_field": "test_value" }
---
"Bulk upload documents":
  - do:
      bulk:
        index: test_index
        body:
          - { "index": { "_id": "2" }}
          - { "test_field": "bulk_value1" }
          - { "index": { "_id": "3" }}
          - { "test_field": "bulk_value2" }
---
"Search a document":
  - do:
      search:
        index: test_index
        body:
          query:
            match:
              test_field: "test_value"
  - match:
      hits.total.value: 1
  - match:
      hits.hits.0._source.test_field: "test_value"
---
"Delete index":
  - do:
      indices.delete:
        index: test_index
